package projectDB;import java.awt.BorderLayout;import java.awt.Component;import java.awt.GridLayout;import java.awt.event.ActionEvent;import java.awt.event.ActionListener;import java.sql.Connection;import java.sql.DriverManager;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.sql.Statement;import javax.swing.JButton;import javax.swing.JCheckBox;import javax.swing.JFrame;import javax.swing.JLabel;import javax.swing.JPanel;import javax.swing.JTextField;import javax.swing.SwingConstants;public class DBedit extends JFrame implements ActionListener {	// 필드 선언	private Connection connection;							// DB 연결	private Statement stmt;									// query 문	private JButton btnEdit, btnDelete, btnClose;			// 기능 버튼	private JPanel centerPanel;								// 데이터 표시 패널		// 생성자 선언	public DBedit() {		setTitle("정보 편집");									// 프레임 제목		setDefaultCloseOperation(EXIT_ON_CLOSE);			// 닫기		setSize(650, 450); 									// 창(프레임) 크기 설정				JPanel topPanel = new JPanel();								// 상단 패널 생성        topPanel.setLayout(new GridLayout(1, 6)); 					// 1행 6열로 균등 분할        topPanel.add(new JLabel("sid", SwingConstants.CENTER));		// 컬럼 제목 (sid)        topPanel.add(new JLabel("name", SwingConstants.CENTER));	// name        topPanel.add(new JLabel("gpa", SwingConstants.CENTER));		// gpa        topPanel.add(new JLabel("year", SwingConstants.CENTER));	// year        topPanel.add(new JLabel("email", SwingConstants.CENTER));	// email        topPanel.add(new JLabel("dept", SwingConstants.CENTER));	// dept                centerPanel = new JPanel();							// 중앙 패널 생성        centerPanel.setLayout(new GridLayout(0, 6));		// 데이터 표시용 레이아웃                JPanel bottomPanel = new JPanel();					// 하단 패널 생성        btnEdit = new JButton("수정");						// 수정 버튼 생성        btnEdit.addActionListener(this);					// 수정 버튼 이벤트 등록        btnDelete = new JButton("삭제");						// 삭제 버튼 생성        btnDelete.addActionListener(this);					// 삭제 버튼 이벤트 등록        btnClose = new JButton("현재창 종료");					// 현재창 종료 버튼 생성        btnClose.addActionListener(this);					// 현재창 종료 버튼 이벤트 등록                bottomPanel.add(btnEdit);							// 패널에 수정 버튼 추가        bottomPanel.add(btnDelete);							// 패널에 삭제 버튼 추가        bottomPanel.add(btnClose);							// 패널에 현재창 종료 버튼 추가        add(topPanel, BorderLayout.NORTH);					// 상단 배치 (상단 패널)        add(centerPanel, BorderLayout.CENTER);				// 중앙 배치 (중앙 패널)        add(bottomPanel, BorderLayout.SOUTH);				// 하단 배치 (하단 패널)                connect();											// DB 연결 메서드 호출        selectList();										// 정보 조회 메서드 호출	}		// 메서드 선언	public void connect() {									// DB 연결 메서드 선언		try {												// JDBC Driver			Class.forName("com.mysql.jdbc.Driver");		} catch(ClassNotFoundException e) {			e.printStackTrace();		}		// DB connection -> idb/testst/boot/12345 (데이터베이스/테이블/계정/패스워드)		String url = "jdbc:mysql://localhost:3306/itdb?useUnicode=true&characterEncoding=utf8&useSSL=false&allowPublicKeyRetrieval=true"; // DB 연결, 인코딩 추가, 인증 및 보안 연결 해제 (개발용)		String username = "boot";		String password = "12345";		try {			connection = DriverManager.getConnection(url, username, password);			// 이름과 학과 값으로 like (유사패턴 검색)를 사용하여 일부분만 일치해도 데이터를 다 검색한다.			stmt = connection.createStatement();		} catch(SQLException e) {			e.printStackTrace();		}	}			public void selectList() {								// 정보 표시 메서드		try {			ResultSet rs = stmt.executeQuery("select * from testst");	// 전체 조회 쿼리 실행			centerPanel.removeAll();									// 기존 패널 초기화			while(rs.next()) {				// 데이터 컴포넌트 생성				JCheckBox cbSid = new JCheckBox(rs.getString("sid"));		// sid (체크박스)				JTextField tfName = new JTextField(rs.getString("name"));	// name (텍스트필드)				JTextField tfGpa = new JTextField(rs.getString("gpa"));		// gpa (텍스트필드)				JTextField tfYear = new JTextField(rs.getString("year"));	// year (텍스트필드)				JTextField tfEmail = new JTextField(rs.getString("email"));	// email (텍스트필드)				JTextField tfDept = new JTextField(rs.getString("dept"));	// dept (텍스트필드)				// 텍스트 가운데 정렬				cbSid.setHorizontalAlignment(JCheckBox.CENTER);				tfName.setHorizontalAlignment(JTextField.CENTER);				tfGpa.setHorizontalAlignment(JTextField.CENTER);				tfYear.setHorizontalAlignment(JTextField.CENTER);				tfEmail.setHorizontalAlignment(JTextField.CENTER);				tfDept.setHorizontalAlignment(JTextField.CENTER);				// 패널에 추가				centerPanel.add(cbSid);				centerPanel.add(tfName);				centerPanel.add(tfGpa);				centerPanel.add(tfYear);				centerPanel.add(tfEmail);				centerPanel.add(tfDept);			}			// 화면 갱신			revalidate();			repaint();		} catch(SQLException e) {			e.printStackTrace();		}	}		private void editDB() {					// 정보 수정 메서드		try {			Component[] comps = centerPanel.getComponents();			String sql = "update testst set name=?, gpa=?, year=?, email=?, dept=? where sid=?";			PreparedStatement pstmt = connection.prepareStatement(sql);						for (int i = 0; i < comps.length; i += 6) {			// 컴포넌트 반복 처리 (6개씩 건너뛰며 한 행 처리)				// 각 컴포넌트 형변환 및 값 가져오기				JCheckBox cbSid = (JCheckBox) comps[i];				JTextField tfName = (JTextField) comps[i+1];				JTextField tfGpa = (JTextField) comps[i+2];				JTextField tfYear = (JTextField) comps[i+3];				JTextField tfEmail = (JTextField) comps[i+4];				JTextField tfDept = (JTextField) comps[i+5];								// SQL 파라미터 설정				pstmt.setString(1, tfName.getText());				pstmt.setString(2, tfGpa.getText());				pstmt.setString(3, tfYear.getText());				pstmt.setString(4, tfEmail.getText());				pstmt.setString(5, tfDept.getText());				pstmt.setString(6, cbSid.getText());								// 쿼리 실행 (현재 화면 값으로 업데이트)				pstmt.executeUpdate();			}			pstmt.close();				// 리소스 해제			selectList();				// 목록 갱신 호출		} catch(SQLException e) {			e.printStackTrace();		}	}		private void deleteDB() {			// 정보 삭제 메서드		try {			Component[] comps = centerPanel.getComponents();			// 패널 컴포넌트 배열 가져오기			String sql = "delete from testst where sid = ?";			// 삭제 쿼리			PreparedStatement pstmt = connection.prepareStatement(sql);						// 컴포넌트 반복 처리			for (int i = 0; i < comps.length; i += 6) {				if (comps[i] instanceof JCheckBox) {					// 첫 번째 요소가 체크박스인지 확인					JCheckBox cb = (JCheckBox) comps[i];						if (cb.isSelected()) {								// 체크된 항목만 삭제						String sid = cb.getText(); 						// sid 값 가져오기						pstmt.setString(1, sid);						pstmt.executeUpdate();							// 삭제 실행					}				}			}			pstmt.close();				// 리소스 해제			selectList();				// 목록 갱신 호출		} catch(SQLException e) {			e.printStackTrace();		}	}		private void disconnect() {			// DB 연결 해제 메서드		try {			if(stmt != null) stmt.close();			if(connection != null) connection.close();		} catch(SQLException e) {			e.printStackTrace();		}	}		// 버튼 클릭 후 Event 처리 메서드 선언	@Override	public void actionPerformed(ActionEvent e) {		Object source = e.getSource();				if(source == btnEdit) {				// 수정 버튼 클릭 시 editDB 호출			editDB();		} else if(source == btnDelete) {	// 삭제 버튼 클릭 시 deleteDB 호출			deleteDB();		} else if(source == btnClose) {					disconnect();					// 연결 해제			dispose();						// 현재 창 닫기		}	}	public static void main(String[] args) {		(new DBedit()).setVisible(true);	// 실행	}}